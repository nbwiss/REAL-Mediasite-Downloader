javascript:(()=>{function displayResults(f){const e=document.getElementById("MSDLmodal");e&&e.remove();const t=document.createElement("div");t.id="MSDLmodal";t.style.position="fixed";t.style.left="50%";t.style.top="50%";t.style.transform="translate(-50%, -50%)";t.style.backgroundColor="white";t.style.padding="20px";t.style.border="1px solid black";t.style.zIndex="10000";t.style.maxWidth="80%";t.style.maxHeight="80%";t.style.overflow="auto";let n='<h3>Mediasite M3U8 Finder</h3>';f.length>0?(n+='<p>Found M3U8 URL(s):</p><textarea id="MSDLtextarea" rows="5" style="width: 95%; word-wrap: break-word; white-space: pre-wrap;" readonly>',n+=f.join("\n\n"),n+='</textarea>',n+='<p><button onclick="document.getElementById(\'MSDLtextarea\').select(); document.execCommand(\'copy\');">Copy All</button></p>'):(n+='<p>Sorry, no M3U8 URL found in the expected locations (API response or common player data).</p>',n+='<p>Check the Browser Console (F12) for logged data objects that might contain the URL.</p>');n+='<p><button onclick="document.getElementById(\'MSDLmodal\').remove();">Close</button></p>';t.innerHTML=n;document.body.appendChild(t)}if(document.getElementById("player-iframe")){alert('MediasiteDownloader: A Mediasite Channel was detected. After you click "OK" you will be redirected to the video. Click Play and then again on the bookmark.\nNote: Your browser may block the redirect. Make sure to allow pop-ups for this website.');window.open(document.getElementById("player-iframe").src);return}try{if(typeof MediasitePlayer==="object"&&typeof SiteData==="object"){console.log("Attempting fetch for newer Mediasite version...");console.log("SiteData object:",SiteData);console.log("MediasitePlayer object:",MediasitePlayer);fetch(window.location.origin+SiteData.PlayerService+'/GetPlayerOptions',{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({'getPlayerOptionsRequest':{'ResourceId':SiteData.PresentationId,'QueryString':'','UseScreenReader':'false','UrlReferrer':''}})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status} ${e.statusText}`);return e.json()}).then(e=>{console.log("Received playerOpts (Newer Version):",e);let t=[];if(e.d?.Presentation?.Streams){e.d.Presentation.Streams.forEach(e=>{if(e.VideoUrls?.length){e.VideoUrls.forEach(e=>{if(e.MimeType&&(e.MimeType.includes("mpegurl")||e.MimeType.includes("m3u8"))||e.Location&&e.Location.includes(".m3u8")){e.Location&&!t.includes(e.Location)&&t.push(e.Location)}})}})}if(e.d?.Presentation?.VodcastUrl?.includes(".m3u8")&&!t.includes(e.d.Presentation.VodcastUrl)){t.push(e.d.Presentation.VodcastUrl)}displayResults(t);if(typeof MediasitePlayer?.pause==="function"){MediasitePlayer.pause()}}).catch(e=>{console.error("Error fetching or processing player options (Newer Version):",e);alert(`Error fetching Mediasite data (Newer Version): ${e.message}\nCheck console (F12) for details.`);displayResults([])})}else if(document.getElementById("ServicePath")&&document.getElementById("ResourceId")){console.log("Attempting fetch for older Mediasite version...");fetch(window.location.origin+document.getElementById("ServicePath").innerHTML+'/GetPlayerOptions',{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({'getPlayerOptionsRequest':{'ResourceId':document.getElementById("ResourceId").innerHTML,'QueryString':'','UseScreenReader':'false','UrlReferrer':''}})}).then(e=>{if(!e.ok)throw new Error(`HTTP error! status: ${e.status} ${e.statusText}`);return e.json()}).then(e=>{console.log("Received playerOpts (Older Version):",e);let t=[];if(e.d?.Presentation?.Streams){e.d.Presentation.Streams.forEach(e=>{if(e.VideoUrls?.length){e.VideoUrls.forEach(e=>{if(e.MimeType&&(e.MimeType.includes("mpegurl")||e.MimeType.includes("m3u8"))||e.Location&&e.Location.includes(".m3u8")){e.Location&&!t.includes(e.Location)&&t.push(e.Location)}})}})}if(e.d?.Presentation?.VodcastUrl?.includes(".m3u8")&&!t.includes(e.d.Presentation.VodcastUrl)){t.push(e.d.Presentation.VodcastUrl)}displayResults(t);if(typeof Mediasite?.Player?.API?.pause==="function"){Mediasite.Player.API.pause()}}).catch(e=>{console.error("Error fetching or processing player options (Older Version):",e);alert(`Error fetching Mediasite data (Older Version): ${e.message}\nCheck console (F12) for details.`);displayResults([])})}else{console.error("Could not determine Mediasite version or find necessary elements/variables.");alert("Could not find expected Mediasite player data on the page. The page structure might have changed.");displayResults([])}}catch(e){console.error("A JavaScript error occurred:",e);alert(`A JavaScript error occurred: ${e.message}\nCheck console (F12) for details.`);displayResults([])}})();